## 1. 构建工具选型

### gulp

* gulp 是一个基于流的自动化构建工具
* gulp 关注的是工作流，着眼于项目的目录文件和类型，去构建项目
* gulp 使用 js 编写配置文件，把所以想做的操作写成 task，由 gulp 去执行

### webpack

* webpack 初衷是模块打包机，基于文件中的依赖关系对文件编译打包，通过 loader 对不同类型的模块进行处理，使用 plugin 来添加额外的功能
* 因为 webpack 是基于模块化，因此可以做代码优化（tree-shaking），代码分割
* webpack 自己实现require，modules.exports，export，让浏览器可以兼容 cjs 和 esm 语法

### rollup

* 适用于开发类库、组件，打包体积更小
* webpack 自己实现 polyfill 支持模块语法，rollup 是利用高版本浏览器原生支持esm（所以rollup无需代码注入，代码体积更精简）
* 可以配置对外暴露模块的方式，esm（es6模块）、cjs（commonjs）、umd（兼容3种写法：cjs，amd，global（global可以初步理解为直接通过window传值）），因此更适合打包类库

## 2 Loader 和 Plugin 区别

* loader 是加载器，webpack 中把一切文件都视为模块，但是 webpack 原生只能解析 js 文件，loader 的作用就是让 webpack 有了加载和解析非 js 文件的能力
* plugin 是插件，用来扩展 webpack 的功能，同时让 webpack 具有更多可能性，在 webpack 运行的生命周期中会广播许多事件，plugin 可以监听这些事件，在合适的时机通过提供的 api 改变输出结果

## 2 webpack 构建流程

* 初始化参数，从配置文件和shell语句中读取与合并参数，得出最终参数
* 开始编译：用上一步得到的参数初始化 Complier 对象，加载所有配置的插件，执行对象的 run 方法开始执行编译；
* 确定入口：根据配置中的 entry 找出所有的入口文件
* 编译模块：从入口文件出发，调用多有配置的 Loader 对模块进行编译，再找出该模块依赖的模块，再递归本步骤直到所有入口的依赖文件都经过了本步骤的处理
* 完成模块编译：再经过上一步使用 Loader 翻译完所有模块后，得到了每个模块被翻译后的最终内容以及它们之间的依赖关系
* 输出资源：根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 Chunk 转换成一个单独的文件加入到输出列表，这步是可以修改输出内容的最后机会
* 输出完成：在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入到文件系统
